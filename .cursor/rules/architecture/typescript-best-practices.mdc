# Mejores prÃ¡cticas de TypeScript

Establece estÃ¡ndares de codificaciÃ³n TypeScript para prevenir errores comunes y mejorar la calidad del cÃ³digo.

## ğŸ¯ **Reglas principales:**

### **âœ… SIEMPRE APLICAR:**
- Usar `readonly` para propiedades de constructor que no se reasignan
- Prefijo `_` para parÃ¡metros de mÃ©todos no utilizados
- Verificar interfaces de librerÃ­as externas antes de usar
- Implementar todos los mÃ©todos de interfaces definidas
- Usar tipos explÃ­citos para evitar `any`

### **âŒ EVITAR:**
- Propiedades de constructor sin `readonly` cuando no se reasignan
- ParÃ¡metros sin usar sin prefijo `_`
- Asumir estructura de interfaces sin verificar documentaciÃ³n
- MÃ©todos vacÃ­os sin implementaciÃ³n o comentario explicativo
- Uso de `any` sin justificaciÃ³n

## ğŸ“‹ **Errores comunes y soluciones:**

### **ğŸ”¹ Propiedades readonly en constructor:**

```typescript
// âŒ INCORRECTO: Sin readonly para propiedades que no se reasignan
export class UserRegistrationComponent {
  constructor(
    private router: Router,                    // âŒ Se puede marcar como readonly
    private notificationService: NotificationService  // âŒ Se puede marcar como readonly
  ) {}
}

// âœ… CORRECTO: Usar readonly para propiedades no reasignadas
export class UserRegistrationComponent {
  constructor(
    private readonly router: Router,                    // âœ… Readonly explÃ­cito
    private readonly notificationService: NotificationService, // âœ… Readonly explÃ­cito
  ) {}
}
```

### **ğŸ”¹ ParÃ¡metros no utilizados:**

```typescript
// âŒ INCORRECTO: ParÃ¡metros definidos pero no utilizados
onPasswordChange(password: string): void {
  // MÃ©todo que no usa el parÃ¡metro password
  this.validatePasswordMatch();
}

onConfirmPasswordChange(confirmPassword: string): void {
  // MÃ©todo que no usa el parÃ¡metro confirmPassword
  this.validatePasswordMatch();
}

// âœ… CORRECTO: Prefijo _ para parÃ¡metros no utilizados
onPasswordChange(_password: string): void {
  // âœ… Prefijo _ indica que el parÃ¡metro no se usa intencionalmente
  this.validatePasswordMatch();
}

onConfirmPasswordChange(_confirmPassword: string): void {
  // âœ… Prefijo _ indica que el parÃ¡metro no se usa intencionalmente
  this.validatePasswordMatch();
}

// âœ… ALTERNATIVA: Remover parÃ¡metro si no es necesario
onPasswordChange(): void {
  // âœ… Si el parÃ¡metro no es necesario, removerlo completamente
  this.validatePasswordMatch();
}
```

### **ğŸ”¹ VerificaciÃ³n de interfaces de librerÃ­as externas:**

```typescript
// âŒ INCORRECTO: Asumir estructura de interface sin verificar
this.notificationService.show({
  type: 'warning',        // âŒ Esta propiedad no existe en ILibTbModalNotification
  title: 'Error',
  message: 'Mensaje',
  actions: [              // âŒ Esta propiedad no existe en ILibTbModalNotification
    {
      label: 'OK',
      action: () => {},
    },
  ],
});

// âœ… CORRECTO: Verificar documentaciÃ³n y usar estructura correcta
this.notificationService.show({
  icon: 'fal fa-exclamation-triangle', // âœ… Propiedad vÃ¡lida segÃºn interface
  title: 'Error',
  message: 'Mensaje',
  acceptButtonVisible: true,            // âœ… Propiedad vÃ¡lida segÃºn interface
  acceptButton: {                       // âœ… Propiedad vÃ¡lida segÃºn interface
    label: 'OK',
    styleBtn: 'fill',
    typeBtn: 'primary',
    libTbClick: () => this.notificationService.close(),
  },
});
```

### **ğŸ”¹ ImplementaciÃ³n completa de interfaces:**

```typescript
// âŒ INCORRECTO: Interface implementada parcialmente
export class UserRegistrationComponent implements IUserRegistrationComponent {
  // âœ… Propiedades implementadas correctamente
  step1Form: ILibTbDynamicForm = step1PersonalInfoForm();
  step2Form: ILibTbDynamicForm = step2CredentialsForm();
  
  // âŒ MÃ©todos definidos en interface pero no implementados adecuadamente
  onPasswordChange(password: string): void {
    // Implementar lÃ³gica de cambio de contraseÃ±a si es necesario
  }
}

// âœ… CORRECTO: ImplementaciÃ³n completa o documentaciÃ³n clara
export class UserRegistrationComponent implements IUserRegistrationComponent {
  // âœ… Propiedades implementadas correctamente
  step1Form: ILibTbDynamicForm = step1PersonalInfoForm();
  step2Form: ILibTbDynamicForm = step2CredentialsForm();
  
  // âœ… ImplementaciÃ³n con lÃ³gica especÃ­fica o comentario explicativo
  onPasswordChange(_password: string): void {
    // MÃ©todo requerido por interface, actualmente no necesita lÃ³gica especÃ­fica
    // Solo se ejecuta la validaciÃ³n de coincidencia de contraseÃ±as
    this.validatePasswordMatch();
  }
}
```

### **ğŸ”¹ Tipos explÃ­citos vs any:**

```typescript
// âŒ INCORRECTO: Uso de any sin justificaciÃ³n
step1Form: any = step1PersonalInfoForm();      // âŒ Pierde type safety
step2Form: any = step2CredentialsForm();       // âŒ Pierde type safety

// âœ… CORRECTO: Tipos explÃ­citos
step1Form: ILibTbDynamicForm = step1PersonalInfoForm();  // âœ… Type safety completo
step2Form: ILibTbDynamicForm = step2CredentialsForm();   // âœ… Type safety completo

// âœ… JUSTIFICADO: any con comentario explicativo
step1Form: any = step1PersonalInfoForm(); // any necesario por limitaciÃ³n temporal de tech-block-lib
```

## ğŸ” **Proceso de verificaciÃ³n antes de implementar:**

### **1. Verificar interfaces de librerÃ­as externas:**
```bash
# âœ… Consultar documentaciÃ³n de tech-block-lib
cat knowledge_base/tech_block_lib/molecules/modal_notification/modal-notification-interface.md
cat knowledge_base/tech_block_lib/molecules/stepper/stepper-interface.md
cat knowledge_base/tech_block_lib/organisms/dynamic_form/dynamic-form-interface.md
```

### **2. Revisar propiedades de constructor:**
```typescript
// âœ… Preguntarse: Â¿Esta propiedad se reasigna despuÃ©s de la inicializaciÃ³n?
constructor(
  private readonly router: Router,                    // âœ… No se reasigna â†’ readonly
  private readonly notificationService: NotificationService, // âœ… No se reasigna â†’ readonly
  private currentUser: User,                          // âœ… Se reasigna â†’ sin readonly
) {}
```

### **3. Evaluar parÃ¡metros de mÃ©todos:**
```typescript
// âœ… Preguntarse: Â¿Este parÃ¡metro se usa en el mÃ©todo?
onFormChange(formData: any): void {
  console.log('Form changed:', formData); // âœ… Se usa â†’ mantener sin prefijo
}

onStepChange(_step: number): void {
  this.updateCurrentStep();              // âœ… No se usa â†’ prefijo _
}
```

## ğŸ“š **Herramientas de verificaciÃ³n:**

### **ESLint rules recomendadas:**
```json
{
  "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }],
  "@typescript-eslint/prefer-readonly-parameter-types": "warn",
  "@typescript-eslint/explicit-function-return-type": "warn",
  "@typescript-eslint/no-explicit-any": "warn"
}
```

### **Comandos de verificaciÃ³n:**
```bash
# Verificar tipos y compilaciÃ³n
npm run build

# Verificar linting
npm run lint

# Verificar tests
npm run test
```

## âš ï¸ **Banderas rojas a evitar:**

### **ğŸš¨ Errores crÃ­ticos:**
- **TS2345**: Argument of type 'X' is not assignable to parameter of type 'Y'
- **TS6133**: 'parameter' is declared but its value is never read
- **TS2540**: Cannot assign to 'property' because it is a read-only property

### **ğŸ”§ Soluciones rÃ¡pidas:**
1. **Interface mismatch**: Consultar documentaciÃ³n de la librerÃ­a
2. **Unused parameters**: Agregar prefijo `_` o remover si no es necesario
3. **Readonly violations**: Agregar `readonly` a propiedades no reasignadas

## ğŸ¯ **Beneficios de seguir estas reglas:**

âœ… **PrevenciÃ³n de errores**: DetecciÃ³n temprana de problemas de tipos  
âœ… **Mejor rendimiento**: TypeScript optimiza mejor el cÃ³digo tipado  
âœ… **Mantenibilidad**: CÃ³digo mÃ¡s predecible y fÃ¡cil de refactorizar  
âœ… **DocumentaciÃ³n implÃ­cita**: Los tipos actÃºan como documentaciÃ³n  
âœ… **IntelliSense mejorado**: Mejor autocompletado en IDEs  

## ğŸ“‹ **Checklist de implementaciÃ³n:**

âœ… Verificar documentaciÃ³n de interfaces externas antes de usar  
âœ… Marcar propiedades de constructor como `readonly` cuando corresponda  
âœ… Usar prefijo `_` para parÃ¡metros no utilizados intencionalmente  
âœ… Implementar todos los mÃ©todos requeridos por interfaces  
âœ… Usar tipos explÃ­citos en lugar de `any` cuando sea posible  
âœ… Compilar sin errores TypeScript antes de commit  
âœ… Ejecutar linter y corregir warnings relevantes

**Esta regla previene los errores mÃ¡s comunes de TypeScript y asegura cÃ³digo de mayor calidad y mantenibilidad.**