---
id: simple-dynamic-form-structure
name: Estructura para formularios din√°micos simples
description: Gu√≠a para crear formularios din√°micos de un solo paso sin stepper, manteniendo organizaci√≥n clara de configs y componentes.
globs:
  - containers/**/*form*/**
  - containers/**/*dynamic*/**
  - "**/*form*.config.ts"
  - "**/*form*.component.ts"
type: comment
alwaysApply: true
---

# Estructura para formularios din√°micos simples

Estructura est√°ndar para formularios din√°micos de **un solo paso** sin stepper usando tech-block-lib.

## üìÅ Estructura de carpetas requerida:

```
src/app/containers/mi-formulario/
‚îú‚îÄ‚îÄ configs/                              # üìÇ Configuraciones separadas
‚îÇ   ‚îú‚îÄ‚îÄ campo1.ts                        # ‚öôÔ∏è Config individual por campo
‚îÇ   ‚îú‚îÄ‚îÄ campo2.ts                        # ‚öôÔ∏è Config individual por campo
‚îÇ   ‚îú‚îÄ‚îÄ campo3.ts                        # ‚öôÔ∏è Config individual por campo
‚îÇ   ‚îî‚îÄ‚îÄ mi-formulario.config.ts          # üìã Config principal del formulario
‚îú‚îÄ‚îÄ mi-formulario.component.ts            # üéÆ L√≥gica principal del formulario
‚îú‚îÄ‚îÄ mi-formulario.component.html          # üñºÔ∏è Template del formulario
‚îú‚îÄ‚îÄ mi-formulario.component.scss          # üé® Estilos del formulario
‚îú‚îÄ‚îÄ mi-formulario.interface.ts            # üìù Interfaces y tipos
‚îú‚îÄ‚îÄ mi-formulario.module.ts               # üì¶ M√≥dulo con importaciones
‚îú‚îÄ‚îÄ mi-formulario-routing.module.ts       # üõ£Ô∏è Rutas del m√≥dulo
‚îî‚îÄ‚îÄ mi-formulario.component.spec.ts       # üß™ Tests unitarios
```

## üî• **REGLA CR√çTICA: formId y name OBLIGATORIOS**

**SIEMPRE** incluir **AMBOS** par√°metros en cada campo de formulario din√°mico. Sin estos, los formularios no funcionan y causan errores de renderizado.

### **‚úÖ PATR√ìN OBLIGATORIO:**
```typescript
// ‚úÖ CORRECTO: Con formId Y name
export const campo: ILibTbDynamicFormConfigType = {
  tbType: 'dropdown|input|number',
  containerId: 'container-id',
  formId: 'nombreUnico',        // ‚úÖ OBLIGATORIO: Para Angular FormControl
  custom: {
    name: 'nombreUnico',        // ‚úÖ OBLIGATORIO: Para atributo HTML name (debe coincidir con formId)
    // ... resto de configuraci√≥n
  }
};
```

### **‚ùå ERRORES COMUNES:**
```typescript
// ‚ùå MAL: Sin formId
export const campo = {
  tbType: 'dropdown',
  containerId: 'container-id',
  // ‚ùå FALTA: formId
  custom: { name: 'campo' }
};

// ‚ùå MAL: Sin name en custom
export const campo = {
  tbType: 'dropdown',
  containerId: 'container-id',
  formId: 'campo',
  custom: {
    // ‚ùå FALTA: name
    label: 'Campo'
  }
};

// ‚ùå MAL: formId y name no coinciden
export const campo = {
  tbType: 'dropdown',
  containerId: 'container-id',
  formId: 'campo',
  custom: {
    name: 'otroNombre', // ‚ùå Debe ser igual a formId
  }
};
```

### **üö® CONSECUENCIAS de omitir formId o name:**
- ‚ùå **Error**: "Falta la propiedad 'name' en la configuraci√≥n"
- ‚ùå **Error**: "Cannot find control with unspecified name attribute"
- ‚ùå **Formularios no renderizan** ‚Üí Stepper muestra contenido vac√≠o
- ‚ùå **Change detection falla** ‚Üí Requiere clicks manuales para funcionar
- ‚ùå **Experiencia de usuario degradada** ‚Üí Aplicaci√≥n aparenta estar rota

### **‚úÖ VERIFICACI√ìN ANTES DE IMPLEMENTAR:**
```typescript
// ‚úÖ CHECKLIST OBLIGATORIO para cada campo:
// 1. ¬øTiene formId definido?
// 2. ¬øTiene name en custom definido?
// 3. ¬øformId === custom.name?
// 4. ¬øNombre es √∫nico en todo el formulario?
```

## üéØ Reglas de nomenclatura:

### **Configuraciones individuales (configs/):**
```typescript
// configs/nombre.ts - ‚úÖ EJEMPLO CORRECTO
export const nombre: ILibTbDynamicFormConfigType = {
  tbType: 'input',
  containerId: 'personal-info-container',
  formId: 'nombre',              // ‚úÖ OBLIGATORIO: Para Angular FormControl
  custom: {
    name: 'nombre',              // ‚úÖ OBLIGATORIO: Debe coincidir con formId
    label: 'Nombre completo',
    placeholder: 'Ingresa tu nombre',
  },
  formProps: {
    validators: [Validators.required, Validators.minLength(2)]
  }
};
```

### **Configuraci√≥n principal (configs/):**
```typescript
// configs/mi-formulario.config.ts
import { ILibTbDynamicForm } from 'tech-block-lib';
import { nombre } from './nombre';
import { email } from './email';
import { telefono } from './telefono';

export const miFormularioConfig = (): ILibTbDynamicForm => {
  return {
    validateOnSubmit: true,
    class: 'grid grid-cols-1 gap-6',
    configContainers: [
      {
        id: 'header-container',
        tagName: 'header',
        class: 'text-center mb-6'
      },
      {
        id: 'personal-info-container',
        tagName: 'section',
        class: 'bg-white p-6 rounded-lg shadow-sm border border-gray-200'
      },
      {
        id: 'contact-info-container', 
        tagName: 'section',
        class: 'bg-white p-6 rounded-lg shadow-sm border border-gray-200'
      }
    ],
    config: [
      // Header
      {
        containerId: 'header-container',
        htmlContent: '<h2 class="lib-tb-h4-bold">Registro de Usuario</h2>'
      },
      
      // Informaci√≥n personal
      {
        containerId: 'personal-info-container',
        htmlContent: '<h3 class="lib-tb-h6-bold mb-4">Informaci√≥n Personal</h3>'
      },
      nombre,     // containerId: 'personal-info-container'
      
      // Informaci√≥n de contacto
      {
        containerId: 'contact-info-container',
        htmlContent: '<h3 class="lib-tb-h6-bold mb-4">Informaci√≥n de Contacto</h3>'
      },
      email,      // containerId: 'contact-info-container'
      telefono,   // containerId: 'contact-info-container'
    ]
  };
};
```

### **Componente principal:**
```typescript
// mi-formulario.component.ts
import { ILibTbDynamicForm, ILibTbButton } from 'tech-block-lib';
import { miFormularioConfig } from './configs/mi-formulario.config';

@Component({
  selector: 'mi-formulario',
  templateUrl: './mi-formulario.component.html',
  styleUrls: ['./mi-formulario.component.scss']
})
export class MiFormularioComponent {
  // ‚úÖ OBLIGATORIO: Un solo formulario din√°mico
  dynamicForm: ILibTbDynamicForm = miFormularioConfig();

  // ‚úÖ OBLIGATORIO: Botones de acci√≥n usando propiedades nativas de tech-block-lib
  btnSubmit: ILibTbButton = {
    label: 'Enviar',
    icon: 'fal fa-paper-plane',
    iconPosition: 'right',
    styleBtn: 'fill',
    typeBtn: 'primary',
    libTbClick: () => this.submitForm(),
  };

  btnReset: ILibTbButton = {
    label: 'Limpiar',
    icon: 'fal fa-redo',
    iconPosition: 'left',
    styleBtn: 'stroke',
    typeBtn: 'secondary',
    libTbClick: () => this.resetForm(),
  };

  // ‚úÖ M√©todos principales
  submitForm(): void {
    this.dynamicForm.libTbCallSubmit?.();
    
    if (this.dynamicForm.form?.valid) {
      const formData = this.dynamicForm.form.value;
      console.log('Datos del formulario:', formData);
      // Enviar datos al servicio...
    } else {
      console.log('Formulario inv√°lido');
    }
  }

  resetForm(): void {
    this.dynamicForm.form?.reset();
  }

  // ‚úÖ M√©todos auxiliares
  get isFormValid(): boolean {
    return this.dynamicForm.form?.valid ?? false;
  }

  get formData(): any {
    return this.dynamicForm.form?.value;
  }
}
```

## üì¶ M√≥dulo requerido:

```typescript
// mi-formulario.module.ts
import { LibTbDynamicFormModule, LibTbButtonModule } from 'tech-block-lib';

@NgModule({
  declarations: [MiFormularioComponent],
  imports: [
    CommonModule,
    ReactiveFormsModule,
    LibTbDynamicFormModule,    // ‚úÖ OBLIGATORIO para formularios din√°micos
    LibTbButtonModule,         // ‚úÖ OBLIGATORIO para botones
    MiFormularioRoutingModule
  ]
})
export class MiFormularioModule {}
```

## üñºÔ∏è Template est√°ndar:

```html
<!-- mi-formulario.component.html -->
<div class="simple-form-container">
  <lib-tb-dynamic-form [custom]="dynamicForm"></lib-tb-dynamic-form>
  
  <div class="form-actions">
    <lib-tb-button [custom]="btnReset"></lib-tb-button>
    <lib-tb-button [custom]="btnSubmit"></lib-tb-button>
  </div>
</div>
```

## üé® Estilos base recomendados (siguiendo reglas BEM):

```scss
// ‚úÖ APLICANDO REGLAS BEM: One Block per File + BEM Naming Convention + Limit Nesting

// Bloque principal del formulario
.form {
  max-width: 600px;
  margin: 0 auto;
  padding: 2rem;

  // ‚úÖ BEM Element: form__actions
  &__actions {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
  }

  // ‚úÖ BEM Modifier: form--mobile
  &--mobile {
    max-width: 100%;
    padding: 1rem;

    .form__actions {
      flex-direction: column;
    }
  }
}

// ‚úÖ Media query aplicando modifier
@media (max-width: 768px) {
  .form {
    @extend .form--mobile;
  }
}
```

### **Reglas BEM aplicadas:**
- ‚úÖ **BEM Naming Convention**: `Block__Element--Modifier`
- ‚úÖ **Limit SCSS Nesting**: M√°ximo 2-3 niveles de anidamiento
- ‚úÖ **One Block per File**: Un bloque principal por archivo SCSS

## ‚ö†Ô∏è Errores comunes a evitar:

‚ùå **Un solo archivo config**: No pongas todos los campos en un archivo gigante  
‚ùå **L√≥gica en configs**: No mezcles l√≥gica de negocio en archivos de configuraci√≥n  
‚ùå **containerId inconsistentes**: Aseg√∫rate que coincidan con configContainers  
‚ùå **Sin validaci√≥n**: No olvides implementar la validaci√≥n del formulario  
‚ùå **Sin manejo de estados**: No manejar los estados loading/error/success

## üéØ Casos de uso recomendados:

- **Formularios de contacto**: Informaci√≥n b√°sica en una sola vista
- **Formularios de login/registro simple**: Sin pasos m√∫ltiples
- **Configuraciones b√°sicas**: Ajustes simples de usuario
- **Formularios de feedback**: Comentarios y valoraciones
- **Filtros de b√∫squeda**: Criterios de b√∫squeda en una sola vista

## üìö Ejemplos de nombres v√°lidos:

‚úÖ **Configs individuales**: `nombre.ts`, `email.ts`, `telefono.ts`  
‚úÖ **Config principal**: `contacto-form.config.ts`, `registro-form.config.ts`  
‚úÖ **Componente**: `contacto-form.component.ts`  
‚úÖ **Interface**: `contacto-form.interface.ts`  
‚úÖ **M√≥dulo**: `contacto-form.module.ts`

## üìã Checklist de implementaci√≥n:

‚úÖ Estructura de carpetas creada  
‚úÖ Interface definida con tipos correctos  
‚úÖ Configs individuales por campo  
‚úÖ Config principal con containers organizados  
‚úÖ Componente con m√©todos submitForm() y resetForm()  
‚úÖ Template con formulario din√°mico y botones  
‚úÖ M√≥dulo con imports necesarios  
‚úÖ Estilos base aplicados  
‚úÖ Validaciones implementadas  
‚úÖ Tests unitarios creados
